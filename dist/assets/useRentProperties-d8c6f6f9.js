import{s as m,b as q,h as d,i as h}from"./index-c523e353.js";const f=10;async function l({page:a,sortPrice:t,properyName:e,searchValue:o}){let r=m.from("PropertiesForRent").select("*",{count:"exact"});if(a){const s=(a-1)*f,i=s+f-1;r.range(s,i)}if(t){if(t==="all")return r;{const[s,i]=t,p=Number(s),y=Number(i);r.gte("price",p).lte("price",y).order("price",{ascending:!0})}}if(e){if(e==="allproperties")return r;r.eq("propertyType",e)}o&&r.eq("name",o);const{data:n,error:c,count:u}=await r;if(c)throw console.error(c),new Error("properties could not be loaded");return{data:n,count:u}}function P(){const a=q(),[t]=d(),e=t.get("page")?Number(t.get("page")):1,o=t.get("price")||!1;let r,n;o?o==="all"?n="all":(r=o.split("-"),n=r):n=!1;const c=t.get("propertyName")||"",u=t.get("query")||"",{isLoading:s,data:{data:i,count:p}={},error:y}=h({queryKey:["rent",e,o,c,u],queryFn:()=>l({page:e,sortPrice:n,properyName:c,searchValue:u})}),g=Math.ceil(p/f);return e<g&&a.prefetchQuery({queryKey:["rent",e+1],queryFn:()=>l({page:e+1})}),e>1&&a.prefetchQuery({queryKey:["rent",e-1],queryFn:()=>l({page:e-1})}),{isLoading:s,rentData:i,count:p}}export{f as P,P as u};
