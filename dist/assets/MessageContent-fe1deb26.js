import{j as e,h as u,b as g,_ as l,S as c,g as m}from"./index-fbe74309.js";import{u as p}from"./index.esm-8f3dfcf2.js";import{r as x,d as y,b as f}from"./apiMessages-902cea57.js";import{u as h}from"./useMutation-72dcc64b.js";import{c as j}from"./createSvgIcon-8a9ea941.js";const v=j(e.jsx("path",{d:"M2.01 21 23 12 2.01 3 2 10l15 2-15 2z"}),"Send");function b(){const{senderID:s}=u(),t=g(),{mutate:r,isLoading:n}=h({mutationFn:a=>{x(s,a)},onSuccess:a=>{t.invalidateQueries({queryKey:["reply"]}),l.success("message sent.")},onError:a=>{l.error("could not send message,try again")}});return{messageReply:r,isLoading:n}}function M(){const{register:s,handleSubmit:t,reset:r}=p(),{messageReply:n,isLoading:a}=b();if(a)return e.jsx(c,{});function i(o){n(o,{onSuccess:d=>r()})}return e.jsx("div",{className:"mt-4",children:e.jsx("form",{onSubmit:t(i),children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("div",{children:e.jsx("input",{type:"text",id:"message",className:"w-[40dvh] rounded-md",...s("message",{required:!0})})}),e.jsx("button",{children:e.jsx(v,{style:{color:"#6366f1"}})})]})})})}function N({message:s}){return e.jsx("div",{className:"mt-2",children:e.jsx("div",{className:"border-solid border-2 rounded-md bg-stone-50 text-left  w-fit p-2 font-Inter ",children:s})})}function S({message:s}){return e.jsx("div",{className:"mt-2",children:e.jsx("div",{className:"border-solid border-2 rounded-md bg-stone-200  text-end  p-2 font-Inter ",children:s})})}function R(){const{senderID:s}=u(),{isLoading:t,data:r,error:n}=m({queryKey:["reply",s],queryFn:()=>y(s)});return{isLoading:t,data:r}}function q(){const{senderID:s}=u(),{isLoading:t,data:r,error:n}=m({queryKey:["Allmessages",s],queryFn:()=>f(s)});return{isLoading:t,data:r}}function F(){const{isLoading:s,error:t,data:r}=q(),{isLoading:n,data:a}=R();if(s)return e.jsx(c,{});if(n)return e.jsx(c,{});const{data:i}=r,{data:o}=a;return e.jsx("div",{className:"flex justify-center items-center md:mt-6 px-2 bg-indigo-50 md:bg-white",children:e.jsx("div",{className:"md:border-2 md:border-solid h-[98dvh] w-[100dvh] md:h-[70dvh] md:w-[100dvh] overflow-y-scroll bg-indigo-50 md:px-4",children:e.jsxs("div",{className:"pt-4",children:[i.map(d=>e.jsx(N,{message:d.message},d.id)),o.map(d=>e.jsx(S,{message:d.message},d.id)),e.jsx(M,{})]})})})}export{F as default};
